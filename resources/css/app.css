@import "tailwindcss";

/* Tailwind v4 content sources (Blade + JS) */
@source "../views/**/*.blade.php";
@source "../js/**/*.js";

@layer base {
  body {
    font-family: "Inter", ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    @apply bg-zinc-50 text-zinc-900;
  }

  a { @apply text-zinc-900; }

  label { @apply text-sm font-extrabold text-zinc-700; }

  input,
  select,
  textarea {
    @apply w-full rounded-2xl border border-zinc-200 bg-white px-3 py-2 text-sm outline-none
      focus:ring-2 focus:ring-sky-200 focus:border-sky-300;
  }

  /* Select global: look consistente en toda la app (filtros/forms admin y tienda) */
  select,
  form select,
  .card select {
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    cursor: pointer;
    border-width: 1px;
    border-style: solid;
    border-color: rgb(228 228 231);
    border-radius: 0.9rem;
    background-color: rgb(255 255 255);
    color: rgb(24 24 27);
    font-weight: 600;
    line-height: 1.25rem;
    box-shadow: 0 1px 2px rgba(15, 23, 42, 0.05);
    padding-right: 2.5rem;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 20 20' fill='none'%3E%3Cpath d='M5.7 7.5a1 1 0 0 1 1.4 0L10 10.4l2.9-2.9a1 1 0 1 1 1.4 1.4l-3.6 3.6a1 1 0 0 1-1.4 0L5.7 8.9a1 1 0 0 1 0-1.4Z' fill='%236b7280'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    background-size: 1rem 1rem;
    transition: border-color 180ms ease, box-shadow 180ms ease, background-color 180ms ease, transform 160ms ease;
  }

  select:hover:not(:disabled),
  form select:hover:not(:disabled),
  .card select:hover:not(:disabled) {
    border-color: rgb(212 212 216);
    background-color: rgb(250 250 250);
  }

  select:focus,
  form select:focus,
  .card select:focus {
    outline: none;
    border-color: rgb(125 211 252);
    box-shadow: 0 0 0 3px rgba(125, 211, 252, 0.35);
    background-color: rgb(255 255 255);
  }

  select:disabled,
  form select:disabled,
  .card select:disabled {
    @apply cursor-not-allowed bg-zinc-100 text-zinc-500;
    box-shadow: none;
  }

  select::-ms-expand { display: none; }

  /* No aplicar flecha custom a selects complejos */
  select[multiple],
  select[size]:not([size="1"]) {
    appearance: auto;
    -webkit-appearance: auto;
    -moz-appearance: auto;
    background-image: none;
    padding-right: 0.75rem;
  }

  /* Custom select global (reemplaza UI nativa visible) */
  .nr-select {
    position: relative;
    width: 100%;
  }

  .nr-select-native {
    position: absolute !important;
    inset: 0 !important;
    opacity: 0 !important;
    pointer-events: none !important;
    height: 100% !important;
    width: 100% !important;
  }

  .nr-select-trigger {
    @apply w-full h-11 rounded-2xl border border-zinc-200 bg-white px-3 text-left text-sm font-semibold text-zinc-900;
    padding-right: 2.5rem;
    box-shadow: 0 1px 2px rgba(15, 23, 42, 0.05);
    transition: border-color 180ms ease, box-shadow 180ms ease, background-color 180ms ease;
  }

  .nr-select-trigger:hover:not(:disabled) {
    @apply border-zinc-300 bg-zinc-50;
  }

  .nr-select-trigger:focus-visible {
    outline: none;
    border-color: rgb(125 211 252);
    box-shadow: 0 0 0 3px rgba(125, 211, 252, 0.35);
    background-color: rgb(255 255 255);
  }

  .nr-select.is-disabled .nr-select-trigger {
    @apply cursor-not-allowed bg-zinc-100 text-zinc-500;
    box-shadow: none;
  }

  .nr-select-label {
    @apply block truncate;
  }

  .nr-select-caret {
    position: absolute;
    right: 0.85rem;
    top: 50%;
    width: 1rem;
    height: 1rem;
    transform: translateY(-50%);
    pointer-events: none;
    transition: transform 160ms ease;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 20 20' fill='none'%3E%3Cpath d='M5.7 7.5a1 1 0 0 1 1.4 0L10 10.4l2.9-2.9a1 1 0 1 1 1.4 1.4l-3.6 3.6a1 1 0 0 1-1.4 0L5.7 8.9a1 1 0 0 1 0-1.4Z' fill='%236b7280'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: center;
    background-size: 1rem 1rem;
  }

  .nr-select.is-open .nr-select-caret {
    transform: translateY(-50%) rotate(180deg);
  }

  .nr-select-menu {
    @apply absolute left-0 right-0 z-50 mt-1 rounded-2xl border border-zinc-200 bg-white p-1 shadow-xl;
    max-height: 15rem;
    overflow-y: auto;
  }

  .nr-select-option {
    @apply w-full rounded-xl px-3 py-2 text-left text-sm font-semibold text-zinc-800 transition-colors;
  }

  .nr-select-option:hover:not(.is-disabled),
  .nr-select-option:focus-visible:not(.is-disabled) {
    @apply bg-zinc-100 text-zinc-900 outline-none;
  }

  .nr-select-option.is-selected {
    @apply bg-sky-50 text-sky-800;
  }

  .nr-select-option.is-disabled {
    @apply text-zinc-400 cursor-not-allowed;
  }
  /* Anti-jitter SIN romper el sidebar:
    NO usar transform en el header (afecta a los fixed del overlay/sidebar) */
  body > header.sticky > .container-page{
    transform: translateZ(0);
    backface-visibility: hidden;
  }


}

@layer components {
  /* =========================
     Layout / Containers
  ========================== */
  .container-page { @apply mx-auto max-w-6xl px-4; }

  /* Mobile: más ancho útil (menos “margen” a los lados) */
  @media (max-width: 640px){
    .container-page{
      padding-left: 5px;
      padding-right: 5px;
    }
  }
  /* Desktop: apenas más ancho que max-w-6xl (72rem) */
  @media (min-width: 1024px){
    .container-page{
      max-width: 76rem;
    }
  }

  .page-head { @apply flex flex-col gap-2 md:flex-row md:items-end md:justify-between mb-4; }
  .page-title { @apply text-xl md:text-2xl font-black tracking-tight; }
  .page-subtitle { @apply text-sm text-zinc-600; }

  /* =========================
     Cards
  ========================== */
  .card { @apply bg-white border border-zinc-100 rounded-2xl shadow-sm; }
  .card-head { @apply px-4 py-3 border-b border-zinc-100 flex items-center justify-between gap-2; }
  .card-body { @apply p-4; }

  /* =========================
     Buttons
     (Tailwind v4: NO @apply a clases custom como "btn")
  ========================== */
  .btn,
  .btn-primary,
  .btn-outline,
  .btn-ghost {
    @apply inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2 text-sm font-extrabold
      border border-transparent transition-all duration-200 ease-out active:scale-[0.98]
      focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-200 focus-visible:ring-offset-2;
    transform: translateY(0);
  }

  .btn-sm { @apply px-3 py-1.5 text-xs rounded-xl; }

  .btn-primary { @apply bg-sky-600 text-white hover:bg-sky-700; }
  .btn-outline { @apply bg-white border-zinc-200 hover:bg-zinc-50; }
  .btn-ghost { @apply bg-transparent hover:bg-zinc-100; }
  .btn-primary:hover,
  .btn-outline:hover { transform: translateY(-1px); }
  .btn-ghost:hover { transform: translateY(-0.5px); }

  /* Icon buttons (base) */
  .icon-btn,
  .btn-cart {
    @apply inline-flex items-center justify-center h-10 w-10 rounded-xl border border-zinc-200 bg-white hover:bg-zinc-50
      transition-all duration-200 ease-out;
    transform: translateY(0);
  }
  .icon-btn:hover,
  .btn-cart:hover { transform: translateY(-1px); }

  /* btn-cart (tienda) */
  .btn-cart { @apply text-sky-700 hover:text-sky-800; }
  .btn-cart svg {
    width: 20px;
    height: 20px;
    display: block;
  }
  .btn-cart.is-disabled {
    @apply opacity-50 cursor-not-allowed hover:bg-white hover:text-sky-700;
  }

  /* =========================
     Badges
     (Tailwind v4: NO @apply a "badge")
  ========================== */
  .badge,
  .badge-zinc,
  .badge-sky,
  .badge-amber,
  .badge-emerald,
  .badge-rose,
  .badge-indigo {
    @apply inline-flex items-center rounded-full px-2.5 py-1 text-xs font-black border;
  }

  .badge-zinc { @apply bg-zinc-50 text-zinc-800 border-zinc-200; }
  .badge-sky { @apply bg-sky-50 text-sky-900 border-sky-200; }
  .badge-amber { @apply bg-amber-50 text-amber-900 border-amber-200; }
  .badge-emerald { @apply bg-emerald-50 text-emerald-900 border-emerald-200; }
  .badge-rose { @apply bg-rose-50 text-rose-900 border-rose-200; }
  .badge-indigo { @apply bg-indigo-50 text-indigo-900 border-indigo-200; }

  /* Badge stock (tienda) */
  .badge-stock {
    @apply inline-flex items-center rounded-full px-2.5 py-1 text-xs font-black border;
  }
  .badge-stock.is-in { @apply bg-emerald-50 text-emerald-900 border-emerald-200; }
  .badge-stock.is-out { @apply bg-rose-50 text-rose-900 border-rose-200; }

  /* =========================
     Alerts
     (Tailwind v4: NO @apply a "alert")
  ========================== */
  .alert,
  .alert-success,
  .alert-error,
  .alert-warning {
    @apply rounded-2xl border px-4 py-3 text-sm font-semibold;
  }

  .alert-success { @apply bg-emerald-50 text-emerald-900 border-emerald-200; }
  .alert-error { @apply bg-rose-50 text-rose-900 border-rose-200; }
  .alert-warning { @apply bg-amber-50 text-amber-900 border-amber-200; }

  /* =========================
     Tables
  ========================== */
  .table-wrap { @apply overflow-x-auto; }
  .table { @apply w-full text-sm; }
  .table thead { @apply bg-zinc-50 text-xs uppercase text-zinc-500; }
  .table th { @apply px-3 py-2 text-left font-black; }
  .table td { @apply px-3 py-2; }
  .table tbody { @apply divide-y divide-zinc-100; }

  /* =========================
     Navbar / Pills
  ========================== */
  .nav-link { @apply text-sm font-extrabold text-zinc-700 hover:text-zinc-900; }

  .nav-pill {
    @apply inline-flex items-center gap-2 rounded-full px-3 py-2 text-xs font-black
      border border-zinc-200 bg-white hover:bg-zinc-50;
  }
  .nav-pill-active { @apply border-sky-300 bg-sky-50 text-sky-900; }

  /* =========================
     Dropdown
  ========================== */
  .dropdown { @apply relative; }
  .dropdown-menu {
    @apply absolute right-0 mt-2 w-56 rounded-2xl border border-zinc-200 bg-white shadow-lg p-2 z-50;
    max-height: min(72dvh, 30rem);
    overflow-y: auto;
    overscroll-behavior: contain;
    -webkit-overflow-scrolling: touch;
    transform-origin: top right;
    opacity: 0;
    transform: translateY(-6px) scale(0.98);
    pointer-events: none;
    transition: opacity 170ms ease, transform 170ms ease;
  }
  .dropdown-menu.is-open {
    opacity: 1;
    transform: translateY(0) scale(1);
    pointer-events: auto;
  }
  .dropdown-menu::-webkit-scrollbar { width: 8px; }
  .dropdown-menu::-webkit-scrollbar-thumb {
    background: #d4d4d8;
    border-radius: 999px;
  }
  .dropdown-menu::-webkit-scrollbar-track { background: transparent; }
  @media (max-width: 640px) {
    .dropdown-menu { width: min(90vw, 18rem); }
  }
  .dropdown.open .dropdown-menu { @apply block; }
  .dropdown-item {
    @apply block px-3 py-2 rounded-xl text-sm font-semibold hover:bg-zinc-100
      transition-colors duration-150 ease-out;
  }

  /* =========================
     SIDEBAR MOBILE (Hamburguesa) — Moderno y ordenado
  ========================== */
  .sidebar-sub { @apply text-xs text-zinc-500; }

  .sidebar-title {
    @apply px-1 text-[11px] font-black uppercase tracking-wider text-zinc-500;
  }

  .sidebar-section {
    @apply rounded-3xl bg-zinc-50/80 ring-1 ring-zinc-200 p-2;
  }

  .sidebar-links { @apply grid gap-1; }

  .sidebar-link {
    @apply w-full flex items-center rounded-2xl px-3 py-2 text-sm font-extrabold text-zinc-800
      hover:bg-white/80 hover:text-zinc-900 transition-colors
      focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-200 focus-visible:ring-offset-2 focus-visible:ring-offset-zinc-50;
  }

  .sidebar-link.active {
    @apply bg-white text-sky-700 ring-1 ring-sky-200 shadow-sm;
  }

  .sidebar-link img { @apply w-5 h-5 shrink-0; }
  .sidebar-link.text-rose-700:hover { @apply bg-rose-50; }

  /* =========================
     TIENDA — Product Card UI
  ========================== */
  .product-card {
    @apply flex flex-col overflow-hidden rounded-2xl border border-zinc-200 bg-white shadow-sm transition hover:shadow-md;
  }

  .product-image {
    @apply block w-full bg-zinc-50 overflow-hidden;
    height: 210px;
  }

  .product-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .product-image-placeholder {
    @apply h-full w-full flex items-center justify-center text-sm font-extrabold text-zinc-500 bg-zinc-100;
  }

  .product-body { @apply p-4 flex flex-col gap-2; }
  .product-title { @apply font-black text-zinc-900 leading-snug hover:underline; }
  .product-meta { @apply text-xs font-semibold text-zinc-500; }

  .product-row { @apply mt-2 flex items-center justify-between gap-2; }
  .product-price { @apply text-lg font-black text-zinc-900; }
  .product-actions { @apply flex items-center gap-2; }

  /* =========================
     TIENDA — Cards en grilla (compactas)
     Para: productos comunes (2 cols móvil / 5 cols desktop)
  ========================== */
  .product-card-grid { height: 100%; }

  .product-card-grid .product-image{
    height: auto;
    aspect-ratio: 1 / 1;
  }

  .product-card-grid .product-image img{
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .product-card-grid .product-body{
    display: flex;
    flex-direction: column;
    flex: 1;
    padding: 10px;
    gap: 6px;
  }

  .product-card-grid .product-title{
    font-size: 13px;
    line-height: 1.2;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    overflow: hidden;
    min-height: calc(1.2em * 2);
  }

  .product-card-grid .product-meta{
    font-size: 11px;
    line-height: 1.1;
  }

  .product-card-grid .product-row{
    margin-top: auto;
    padding-top: 6px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: stretch;
    width: 100%;
  }

  .product-card-grid .product-actions{
    display: flex;
    width: 100%;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
  }

  .product-card-grid .product-price{
    font-size: 15px;
    font-weight: 800;
    text-align: left;
    align-self: flex-start;
  }

  .product-card-grid .badge-stock{
    font-size: 10px;
    padding: 2px 8px;
  }

  .product-card-grid .btn-cart{
    width: 34px;
    height: 34px;
    border-radius: 12px;
  }

  .product-card-grid .btn-cart svg{
    width: 18px;
    height: 18px;
  }

  /* =========================
     TIENDA — Destacados (compacto para carrusel) — CONSOLIDADO
     (mantiene el look actual y evita duplicados)
  ========================== */
  .product-card-featured .product-image{
    height: auto;
    aspect-ratio: 1 / 1;
  }

  .product-card-featured .product-body{
    padding: 12px;
    gap: 8px;
  }

  .product-card-featured .product-title{
    font-size: 14px;
    line-height: 1.2;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    overflow: hidden;
    min-height: calc(1.2em * 2);
    margin: 0;
  }

  .product-card-featured .product-price{
    font-size: 16px;
    font-weight: 800;
  }

  .product-card-featured .product-row{
    margin-top: auto;
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }

  .product-card-featured .product-actions{
    width: 100%;
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: nowrap; /* clave: no bajar a otra línea */
  }

  .product-card-featured .product-actions .badge-stock{
    flex: 0 1 auto;      /* NO ocupa todo el ancho */
    white-space: nowrap; /* no parte "Stock" */
    max-width: calc(100% - 44px); /* deja espacio al botón */
    overflow: hidden;
    text-overflow: ellipsis;
  }
    @media (max-width: 640px){
    .product-card-featured .product-actions .badge-stock{
      display: none;
    }
  }



  /* El form no debe estirarse ni empujar */
  .product-card-featured .product-actions form{
    flex: 0 0 auto;
    margin: 0;
    margin-left: auto; /* clave: manda el carrito a la esquina derecha */
  }


  /* El botón queda siempre adentro y alineado a la derecha */
  .product-card-featured .product-actions .btn-cart{
    flex: 0 0 auto;
    margin-left: auto;
  }


  .product-card-featured .badge-stock{
    font-size: 10px;
    padding: 2px 8px;
    border-radius: 9999px;
  }

  .product-card-featured .btn-cart{
    height: 36px;
    width: 36px;
    border-radius: 12px;
  }

  .product-card-featured .btn-cart svg{
    width: 18px;
    height: 18px;
  }

  @media (max-width: 640px){
    .product-card-grid .product-body{
      padding: 12px;
      gap: 8px;
    }

    .product-card-grid .product-title{
      font-size: 14px;
    }

    .product-card-grid .product-price{
      font-size: 16px;
    }

    .product-card-grid .btn-cart,
    .product-card-featured .btn-cart{
      width: 40px;
      height: 40px;
      border-radius: 14px;
    }

    .product-card-grid .btn-cart svg,
    .product-card-featured .btn-cart svg{
      width: 20px;
      height: 20px;
    }
  }

  /* =========================
     Helpers / Legacy
  ========================== */
  .muted { @apply text-sm text-zinc-600; }

  .hero { @apply bg-white border border-zinc-100 rounded-2xl shadow-sm; }
  .hero-title { @apply text-xl md:text-2xl font-black tracking-tight; }
  .hero-text { @apply text-sm text-zinc-600; }

  .orders-list { @apply grid gap-3; }
  .order-card { @apply bg-white border border-zinc-100 rounded-2xl shadow-sm p-4; }

  /* =========================
     Scroll lock / Toast smooth
  ========================== */
  html { scrollbar-gutter: stable both-edges; }

  html.nr-scroll-lock,
  body.nr-scroll-lock { overflow: hidden; }

  body.nr-scroll-lock {
    padding-right: var(--nr-sbw, 0px);
    touch-action: none;
  }

  @media (prefers-reduced-motion: reduce) {
    .btn,
    .btn-primary,
    .btn-outline,
    .btn-ghost,
    .icon-btn,
    .btn-cart,
    .dropdown-menu,
    .dropdown-item {
      transition: none !important;
      transform: none !important;
    }
  }

  .nr-no-transition { transition: none !important; }
}
